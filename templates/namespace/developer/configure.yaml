{{ define "rhtap.namespace.developer.configure" }}
NAMESPACE_LIST=(
{{range (index .Values "trusted-application-pipeline" "namespaces")}} {{printf "%s-development" . | quote}} {{printf "%s-stage" . | quote}} {{printf "%s-prod" . | quote}}
{{end}}
)

for NAMESPACE in "${NAMESPACE_LIST[@]}"; do
  echo -n "* Configuring '$NAMESPACE' namespace: "
  cat << EOF | sed "s|^metadata:.*|\0\n  namespace: $NAMESPACE|" | kubectl create --filename - >/dev/null
{{include "rhtap.namespace.dev_setup_pipelinerun" .}}
EOF
  echo "OK"
done
{{end}}